"use strict";angular.module("kscrPocApp",["ngAnimate","ngResource","ngSanitize","ngTouch","ui.router"]).config(["$httpProvider","$stateProvider","$urlRouterProvider",function(a,b,c){a.defaults.useXDomain=!0,b.state("app",{"abstract":!0,templateUrl:"partials/app.html",controller:["$scope","termsService",function(a,b){a.searchCriteria={termId:"kuali.atp.2012Fall",term:null,query:"CHEM23"},a.terms=b.query(),a.showSearch=!1,a.$watch("searchCriteria.termId",function(){})}]}).state("app.search",{"abstract":!0,template:"<div ui-view></div>"}).state("app.search.query",{url:"/search",templateUrl:"partials/app.search.query.html",data:{title:"Search"},controller:["$scope","$state",function(a,b){a.search=function(){b.go("app.search.results.list")}}]}).state("app.search.results",{"abstract":!0,url:"/results",templateUrl:"partials/app.search.results.html",controller:["$scope","primaryActivityOfferingService","regGroupService",function(a,b,c){a.results=b.query({termCode:"201208",courseCode:a.searchCriteria.query}),c.get({termCode:"201201",courseCode:"CHEM237"}).then(function(a){console.log("all",a)}),c.getByAOIds({termCode:"201201",courseCode:"CHEM237"},["6b1354c2-953d-4099-a773-83a562566bac"]).then(function(a){console.log("limited",a)})}]}).state("app.search.results.list",{url:"",templateUrl:"partials/app.search.results.list.html",data:{title:"3 results"}}).state("app.search.results.details",{url:"/:index/:code",templateUrl:"partials/app.search.results.details.html",controller:["$scope","$state","$stateParams","pagingService","regGroupService",function(a,b,c,d,e){var f=d.get("primaryActivityOffering");return a.item=f.item(c.index),null===a.item?(b.go("app.search.results.list"),void 0):(a.previousItem=f.previous(c.index),a.nextItem=f.next(c.index),console.log(a),e.getByAOIds({termCode:"201208",courseCode:a.item.courseOfferingCode},a.item.activityOfferingId).then(function(a){console.log("working",a)}),e.get({termCode:"201208",courseCode:a.item.courseOfferingCode}).then(function(a){console.log("hurray",a)}),a.activityOfferings=[{id:"1a",time:"TuTh 9-9:50am"},{id:"2b",time:"MoWeFri 11am-1:15pm"}],void 0)}]}).state("app.search.results.activity",{url:"/activity",templateUrl:"partials/app.search.results.details.activities.html",controller:["$scope",function(a){a.activityOfferings=[{id:"1a",time:"TuTh 9-9:50am"},{id:"2b",time:"MoWeFri 11am-1:15pm"}],a.selectedActivityOffering=null,a.$watch("selectedActivityOffering",function(a){console.log("selected",a)})}]}).state("app.schedule",{url:"/schedule",templateUrl:"partials/app.schedule.html",data:{title:"Schedule"},controller:["$scope","ScheduleService",function(a,b){a.schedule=b}]}),c.otherwise("/search")}]).run(["$rootScope","$state",function(a,b){a.$state=b;var c="Course Registration";a.pageTitle=c,a.$on("$stateChangeSuccess",function(b,d){var e=[c];angular.isDefined(d.data)&&angular.isDefined(d.data.title)&&e.unshift(d.data.title),a.pageTitle=e.join(" - ")}),a.srefs={};var d=function(c,d,e){a.srefs[c]=b.href(d,e)};d("app.search","app.search.query"),a.$on("$stateChangeSuccess",function(c,e,f){angular.forEach(a.srefs,function(a,c){b.includes(c)&&d(c,e,f)})})}]),angular.module("kscrPocApp").controller("MainCtrl",["$scope",function(a,b){a.results=b}]),angular.module("kscrPocApp").filter("credits",["$sce",function(a){var b="CR",c=b+"";return function(d){switch(d.creditType){case"range":return a.trustAsHtml(d.minCredits+"&ndash;"+d.maxCredits+" "+c);case"multiple":return d.multipleCredits.join(", ")+" "+c;default:return d.fixedCredits+" "+(1===d.fixedCredits?b:c)}}}]),angular.module("kscrPocApp").filter("days",function(){var a="sun,mon,tue,wed,thu,fri,sat".split(","),b=a.length,c={"short":{labels:"Su,M,Tu,W,Th,F,Sa".split(","),delimiter:""},medium:{labels:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),delimiter:", "},"long":{labels:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),delimiter:", "}};return function(d,e){e=angular.isDefined(e)?e:"short";for(var f=c[e],g=[],h=0;b>h;h++)d[a[h]]&&g.push(f.labels[h]);return g.join(f.delimiter)}}),angular.module("kscrPocApp").filter("timeRange",["$sce",function(a){return function(b){return a.trustAsHtml([b.startTime,b.endTime].join("&ndash;"))}}]),angular.module("kscrPocApp").filter("meetingTimes",["$sce","daysFilter","timeRangeFilter",function(a,b,c){return function(d){return a.trustAsHtml([b(d),c(d)].join(" "))}}]),angular.module("kscrPocApp").filter("instructors",function(){return function(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c];b.push([e.firstName,e.lastName].join(" "))}return b.join(", ")}}),angular.module("kscrPocApp").factory("SearchResultsService",function(){var a=[{index:1,id:"59c680a6-b97c-4fc9-87c2-b2e48b8c8c83",courseOfferingCode:"ENGL233",title:"Introduction to Asian American Literature",creditType:"range",fixedCredits:1,maxCredits:3,minCredits:1,multipleCredits:[1.5,3,5],isHonors:!1,scheduleItems:[{isSun:!1,isMon:!0,isTue:!1,isWed:!0,isThu:!1,isFri:!1,isSat:!1,startTime:"13:00",endTime:"15:00"},{isSun:!1,isMon:!1,isTue:!1,isWed:!1,isThu:!1,isFri:!0,isSat:!1,startTime:"11:30",endTime:"12:45"}],type:"Lecture",instructorNames:[{firstName:"Emmett",lastName:"Brown"},{firstName:"Sara",lastName:"Connors"}],enrollmentCount:20,maxEnrollmentCount:30},{index:2,id:"59c680a6-b97c-4fc9-87c2-b2e48b8c8c84",courseOfferingCode:"GIGW121",title:"Urban Skateboarding",creditType:"fixed",fixedCredits:3,isHonors:!1,scheduleItems:[{isTue:!0,isThu:!0,startTime:"09:00",endTime:"12:00"}],type:"Lecture",instructorNames:[{firstName:"Marty",lastName:"McFly"}],enrollmentCount:7,maxEnrollmentCount:20},{index:3,id:"59c680a6-b97c-4fc9-87c2-b2e48b8c8c85",courseOfferingCode:"TRDS923",title:"Theories of Wibbly Wobbly",creditType:"multiple",multipleCredits:[1,5],isHonors:!0,scheduleItems:[{isSat:!0,startTime:"14:30",endTime:"18:00"}],type:"Lecture",instructorNames:[{firstName:"Doctor",lastName:"Who"}],enrollmentCount:0,maxEnrollmentCount:3}],b=[];angular.forEach(a,function(a){b[a.index]=a});var c=function(a,c){return a=angular.isString(a)?parseInt(a):a,a+=angular.isDefined(c)?c:0,b[a]||null};return{results:a,count:a.length,item:function(a){return c(a,0)},next:function(a){return c(a,1)},previous:function(a){return c(a,-1)}}}),angular.module("kscrPocApp").value("ScheduleService",[{termName:"Fall 2012",registrationGroups:[{courseCode:"CHEM105",courseTitle:"Introduction to Chemistry",creditType:"fixed",fixedCredits:4,activityOfferings:[{type:"Lecture",isMon:!0,isWed:!0,isFri:!0,startTime:"13:00",endTime:"15:00",buildingCode:"CHM",roomCode:"1105"}]}]}]),angular.module("kscrPocApp").factory("CourseOfferingService",["$resource","config",function(a,b){return a(b.apiBase+"courseofferings")}]),angular.module("kscrPocApp").factory("primaryActivityOfferingService",["$resource","config","$filter","pagingService",function(a,b,c,d){var e=d.get("primaryActivityOffering").clean();return a(b.apiBase+"courseofferings/primaryactivities",{},{query:{method:"GET",transformResponse:function(a){a=angular.fromJson(a);for(var b=1,d=0,f=a.length;f>d;d++)for(var g=a[d],h=0,i=g.primaryActivityOfferingInfo.length;i>h;h++,b++){for(var j=g.primaryActivityOfferingInfo[h],k=0,l=j.instructors.length;l>k;k++){var m=j.instructors[k].displayName;if(angular.isString(m)){var n=c("namecase")(m).split(", "),o=n[1],p=n[0],q={firstName:o,lastName:p,fullName:[o,p].join(" ")};angular.extend(j.instructors[k],q)}}var r={index:b,creditType:"fixed",fixedCredits:parseFloat(g.courseOfferingInfo.courseOfferingCreditOptionDisplay)};angular.extend(r,g.courseOfferingInfo),angular.extend(r,j),e.addItem(r,b)}return e}}})}]),angular.module("kscrPocApp").value("config",{apiBase:"http://env17.ks.kuali.org/services/ScheduleOfClassesService/"}),angular.module("kscrPocApp").factory("termsService",["$resource","config",function(a,b){return a(b.apiBase+"terms")}]),angular.module("kscrPocApp").filter("namecase",function(){var a={};a.checkName=function(a){return a===a.toLowerCase()||a===a.toUpperCase()},a.singleField=function(a){return b(a)},a.combinedField=function(a){return a.charAt(0).toUpperCase()+b(a).substring(1)};var b=function(a){return a=a.trim().toLowerCase().replace(/\b(\w)/g,function(a){return a.toUpperCase()}).replace(/(\'\w)\b/g,function(a){return a.toLowerCase()}),(new RegExp(/\bMac[A-Za-z]{2,}[^aciozj]\b/).test(a)||new RegExp(/\bMc/).test(a))&&(a=a.replace(/\b(Ma?c)([A-Za-z]+)/,function(a,b,c){return b+c.charAt(0).toUpperCase()+c.substring(1)}),a=a.replace(/\bMacEvicius\b/,"Macevicius").replace(/\bMacHado\b/,"Machado").replace(/\bMacHar\b/,"Machar").replace(/\bMacHin\b/,"Machin").replace(/\bMacHlin\b/,"Machlin").replace(/\bMacIas\b/,"Macias").replace(/\bMacIulis\b/,"Maciulis").replace(/\bMacKie\b/,"Mackie").replace(/\bMacKle\b/,"Mackle").replace(/\bMacKlin\b/,"Macklin").replace(/\bMacQuarie\b/,"Macquarie").replace(/\bMacOmber\b/,"Macomber").replace(/\bMacIn\b/,"Macin").replace(/\bMacKintosh\b/,"Mackintosh").replace(/\bMacKen\b/,"Macken").replace(/\bMacHen\b/,"Machen").replace(/\bMacHiel\b/,"Machiel").replace(/\bMacIol\b/,"Maciol").replace(/\bMacKell\b/,"Mackell").replace(/\bMacKlem\b/,"Macklem").replace(/\bMacKrell\b/,"Mackrell").replace(/\bMacLin\b/,"Maclin").replace(/\bMacKey\b/,"Mackey").replace(/\bMacKley\b/,"Mackley").replace(/\bMacHell\b/,"Machell").replace(/\bMacHon\b/,"Machon")),a=a.replace(/\bMacmurdo/,"MacMurdo").replace(/\bMacisaac/,"MacIsaac"),a=a.replace(/\bAl(?=\s+\w)/g,"al").replace(/\bAp\b/g,"ap").replace(/\bBen(?=\s+\w)\b/g,"ben").replace(/\bDell([ae])\b/g,"dell$1").replace(/\bD([aeiu])\b/g,"d$1").replace(/\bDe([lr])\b/g,"de$1").replace(/\bEl\b/g,"el").replace(/\bLa\b/g,"la").replace(/\bL([eo])\b/g,"l$1").replace(/\bVan(?=\s+\w)/g,"van").replace(/\bVon\b/g,"von"),a=a.replace(/\b(?:\d{4}|(?:[IVX])(?:X{0,3}I{0,3}|X{0,2}VI{0,3}|X{0,2}I?[VX]))$/i,function(a){return a.toUpperCase()}),a=a.replace(/\b[0-9](x)\b/,function(a){return a.toUpperCase()})};return function(b){return angular.isString(b)?a.singleField(b):""}}),angular.module("kscrPocApp").factory("pagingService",function(){function a(a){for(var b=[],c=0,d=a.length;d>c;c++)a[c]&&b.push(a[c]);return b}function b(a){this.id=a,this._indexedItems=[],this.items=[],this.itemCount=0,d[a]=this}function c(a){return angular.isDefined(d[a])?d[a]:new b(a)}var d={};return b.prototype={addItem:function(b,c){c=angular.isNumber(c)?c:this.items.length,this._indexedItems[c]=b,this.items=a(this._indexedItems),this.itemCount=this.items.length},getItem:function(a,b){return a=angular.isString(a)?parseInt(a):a,a+=angular.isDefined(b)?b:0,this._indexedItems[a]||null},item:function(a){return this.getItem(a,0)},next:function(a){return this.getItem(a,1)},previous:function(a){return this.getItem(a,-1)},clean:function(){return this._indexedItems=[],this.items=[],this.itemCount=0,this}},{get:function(a){return c(a)},clean:function(a){var b=c(a);return b.clean(),b}}}),angular.module("kscrPocApp").factory("regGroupService",["$http","config","$q",function(a,b,c){function d(a,b){for(var c=0,d=b.length;d>c;c++)if(-1===a.indexOf(b[c]))return!1;return!0}return{get:function(d){var e={params:d},f=a.get(b.apiBase+"reggroups",e),g=a.get(b.apiBase+"activityofferings",e);return c.all([f,g]).then(function(a){var b=a[0].data,c=a[1].data,d={};return angular.forEach(c,function(a){d[a.activityOfferingId]=a}),angular.forEach(b,function(a){a.activityOfferings=[],angular.forEach(a.activityOfferingIds,function(b){a.activityOfferings.push(d[b])})}),b})},getByAOIds:function(a,b){return b=angular.isArray(b)?b:[b],this.get(a).then(function(a){var c=[];return angular.forEach(a,function(a){d(a.activityOfferingIds,b)&&c.push(a)}),c})}}}]);